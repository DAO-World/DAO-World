{"version":3,"sources":["../../src/utils/apps.js"],"names":["apmAppId","appName","findAppMethodFromData","app","data","methodId","substring","deprecatedFunctions","functions","method","Array","isArray","find","sig","deprecatedFunctionsFromVersions","Object","values","every","allDeprecatedFunctions","concat","knownAppIds"],"mappings":"iEAyduB;oLAtdhB,KAAMA,CAAAA,QAAQ,CAAGC,OAAO,EAAI,yBAAU,GAAEA,OAAQ,eAApB,CAA5B,CAEP;;;;;;;6BAQO,QAASC,CAAAA,qBAAT,CAAgCC,GAAhC,CAAqCC,IAArC,CAA2C,MAC1CC,CAAAA,QAAQ,CAAGD,IAAI,CAACE,SAAL,CAAe,CAAf,CAAkB,EAAlB,CAD+B,CAE1C,CAAEC,mBAAF,CAAuBC,SAAvB,EAAqCL,GAAG,EAAI,EAFF,CAIhD,GAAIM,CAAAA,MAAJ,CACA;AAOA,GANIC,KAAK,CAACC,OAAN,CAAcH,SAAd,CAMJ,GALEC,MAAM,CAAGD,SAAS,CAACI,IAAV,CACPH,MAAM,EAAI,4BAAaA,MAAM,CAACI,GAApB,EAAyBP,SAAzB,CAAmC,CAAnC,CAAsC,EAAtC,IAA8CD,QADjD,CAKX,EAAI,CAACI,MAAL,CAAa,CACX;AACA,KAAMK,CAAAA,+BAA+B,CAAGC,MAAM,CAACC,MAAP,CAAcT,mBAAmB,EAAI,EAArC,CAAxC,CACA,GAAIO,+BAA+B,CAACG,KAAhC,CAAsCP,KAAK,CAACC,OAA5C,CAAJ,CAA0D,CACxD;AACA,KAAMO,CAAAA,sBAAsB,CAAG,GAAGC,MAAH,CAAU,GAAGL,+BAAb,CAA/B,CACAL,MAAM,CAAGS,sBAAsB,CAACN,IAAvB,CACPH,MAAM,EAAI,4BAAaA,MAAM,CAACI,GAApB,EAAyBP,SAAzB,CAAmC,CAAnC,CAAsC,EAAtC,IAA8CD,QADjD,CAGV,CACF,CAED,MAAOI,CAAAA,MACR,CAEM,KAAMW,CAAAA,WAAW,CAAG,CACzBpB,QAAQ,CAAC,SAAD,CADiB,CAEzBA,QAAQ,CAAC,eAAD,CAFiB,CAGzBA,QAAQ,CAAC,OAAD,CAHiB,CAIzBA,QAAQ,CAAC,QAAD,CAJiB,CAApB,C","sourcesContent":["import { hash as namehash } from 'eth-ens-namehash'\nimport { soliditySha3 } from 'web3-utils'\n\nexport const apmAppId = appName => namehash(`${appName}.aragonpm.eth`)\n\n/**\n * Find the method descriptor corresponding to the data component of a\n * transaction sent to `app`.\n *\n * @param  {Object} app App artifact\n * @param  {Object} data Data component of a transaction to app\n * @return {Object|void} Method with radspec notice and function signature, or undefined if none was found\n */\nexport function findAppMethodFromData (app, data) {\n  const methodId = data.substring(2, 10)\n  const { deprecatedFunctions, functions } = app || {}\n\n  let method\n  // First try to find the method in the current functions\n  if (Array.isArray(functions)) {\n    method = functions.find(\n      method => soliditySha3(method.sig).substring(2, 10) === methodId\n    )\n  }\n\n  if (!method) {\n    // The current functions didn't have it; try with each deprecated version's functions\n    const deprecatedFunctionsFromVersions = Object.values(deprecatedFunctions || {})\n    if (deprecatedFunctionsFromVersions.every(Array.isArray)) {\n      // Flatten all the deprecated functions\n      const allDeprecatedFunctions = [].concat(...deprecatedFunctionsFromVersions)\n      method = allDeprecatedFunctions.find(\n        method => soliditySha3(method.sig).substring(2, 10) === methodId\n      )\n    }\n  }\n\n  return method\n}\n\nexport const knownAppIds = [\n  apmAppId('finance'),\n  apmAppId('token-manager'),\n  apmAppId('vault'),\n  apmAppId('voting')\n]\n"],"file":"apps.js"}